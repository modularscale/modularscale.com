//= require '_ms.js.erb'
//= require '_panels.js.erb'

// Vars

var mode = 'web';
var panel = 'form';
var bases = '1em';
var ratios = 1.3;



function changeBase(e) {
  msBase = e.value.match(/^(\d+(?:\.\d+)?)(.*)$/)[1];
  msUnit = e.value.match(/^(\d+(?:\.\d+)?)(.*)$/)[2];
  msPage(msBase, msUnit, msRatio);
}
function changeRatio(e) {
  msRatio = e.value;
  msPage(msBase, msUnit, msRatio);
}

function stepUnits(u, msBase, msUnit, msRatio) {
  if (msUnit == 'em') {
    return (Math.round((ms(u,1,msRatio))*1000)/1000)+'em';
  } else {
    return (Math.round((ms(u,msBase,msRatio))*1000)/1000)+msUnit + ' / ' + (Math.round((ms(u,1,msRatio))*1000)/1000)+'em';
  }
}

// alert(ms(3, 1, 1.5));

function msPage(msBase, msUnit, msRatio) {

  // upper bound of scale
  var u = 10;
  // lower bound of scale
  var l = -6;
  while (u >= l) {
    if (u >= 0) {
      document.getElementById('m'+u+'value').innerHTML=stepUnits(u, msBase, msUnit, msRatio);
      document.getElementById('text_m'+u).style.fontSize=(ms(u,msBase,msRatio)+msUnit);
    } else {
      document.getElementById('mn'+Math.abs(u)+'value').innerHTML=stepUnits(u, msBase, msUnit, msRatio);
      document.getElementById('text_mn'+Math.abs(u)).style.fontSize=(ms(u,msBase,msRatio)+msUnit);
    }
    u--;
  }
}

// base
var msBase = 1;
// unit
var msUnit = 'em';
// ratio
var msRatio = 1.2;

document.addEventListener('DOMContentLoaded', function(){
  msPage(msBase, msUnit, msRatio);
});